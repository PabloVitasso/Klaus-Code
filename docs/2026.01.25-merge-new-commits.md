# Upstream Merge Tracking - 2026-01-25 (New Commits)

## Overview

This document tracks the merge of 4 new upstream Roo Code commits into Klaus Code.

**Upstream Repository:** https://github.com/RooCodeInc/Roo-Code
**Last Merged Commit:** c7910a99c (2026-01-24)
**Target Commit:** 953c7773c (2026-01-25)
**Total Commits to Merge:** 4

## Critical Areas to Protect

Klaus Code maintains these features that must not be affected:

1. **Claude Code Provider** (`src/api/providers/claude-code.ts`, `src/integrations/claude-code/`)
2. **OAuth Integration** (`src/integrations/claude-code/oauth.ts`)
3. **Tool Name Prefixing** (`src/integrations/claude-code/streaming-client.ts`)
4. **Klaus Code Branding** (various files)

---

## Merge Summary

All 4 upstream commits have been successfully merged!

### Batch 1 (2026-01-25) - Commits 1 & 2

| Commit    | Description        | Risk   | Status    |
| --------- | ------------------ | ------ | --------- |
| 953c7773c | zh-TW translations | ðŸŸ¢ LOW | âœ… MERGED |
| b472c1522 | Settings UI fix    | ðŸŸ¢ LOW | âœ… MERGED |

**Files Changed:** 2 (conflicts resolved with `git checkout --ours` to preserve Klaus Code branding)
**Tests:** Type check passed, lint passed

### Batch 2 (2026-01-25) - Commit 3

| Commit    | Description          | Risk      | Status    |
| --------- | -------------------- | --------- | --------- |
| c28478eda | MCP wildcard support | ðŸŸ¡ MEDIUM | âœ… MERGED |

**Files Changed:** ~5 files (auto-merged cleanly)
**Tests:**

- MCP Hub tests: 47/47 âœ…
- Claude Code tests: 44/44 âœ…
- Type check: passed âœ…

### Batch 3 (2026-01-25) - Commit 4 (Worktree UI Overhaul)

| Commit    | Description          | Risk      | Status    |
| --------- | -------------------- | --------- | --------- |
| c56f0f43c | Worktree UI overhaul | ðŸŸ¡ MEDIUM | âœ… MERGED |

**Files Changed:** 95 files (complex UI changes)
**Conflicts Resolved:**

- `src/package.json` - dependency version changes
- `webview-ui/src/i18n/locales/en/worktrees.json` - branding

**Additional Fixes:**

- Fixed import paths in new WorktreeSelector component (`@roo-code/types` â†’ `@klaus-code/types`)
- Added missing i18n translation for `%command.worktrees.title%` to all 17 package.nls files

**Tests:**

- Type check: passed âœ…
- Lint: passed âœ…
- Claude Code tests: 44/44 âœ…
- MCP Hub tests: 47/47 âœ…
- WorktreeSelector tests: 18/18 âœ…

**VSIX Build:** `bin/klaus-code-3.43.0.vsix` âœ…

---

## Commit Tracking (Archive)

### 1. 953c7773c - Update and improve zh-TW Traditional Chinese locale and docs (#10953)

**Date:** 2026-01-25
**Author:** Peter Dave Hello
**Risk Level:** ðŸŸ¢ **LOW RISK**
**Status:** âœ… MERGED

**Description:** Updates and improves zh-TW (Traditional Chinese) translations for locale files and docs.

**Resolution:** Used `git checkout --ours` to preserve Klaus Code branding in zh-TW files.

---

### 2. b472c1522 - fix: restore opaque background to settings section headers (#10951)

**Date:** 2026-01-25
**Author:** roomote[bot]
**Risk Level:** ðŸŸ¢ **LOW RISK**
**Status:** âœ… MERGED

**Description:** Restores opaque background to settings section headers that were made transparent.

**Resolution:** Auto-merged cleanly with no conflicts.

---

### 3. c28478eda - feat: add wildcard support for MCP alwaysAllow configuration (#10948)

**Date:** 2026-01-24
**Author:** roomote[bot]
**Risk Level:** ðŸŸ¡ **MEDIUM RISK**
**Status:** âœ… MERGED

**Description:** Adds wildcard support (`*`) for MCP alwaysAllow configuration, allowing users to approve all tools from a server.

**Files:**

- `src/services/mcp/McpHub.ts` - Wildcard matching logic
- `src/services/mcp/__tests__/McpHub.spec.ts` - New tests

**Resolution:** Auto-merged cleanly. Tests verified.

---

### 4. c56f0f43c - ux: improve worktree selector and creation UX (#10940)

**Date:** 2026-01-24
**Author:** Bruno Bergher
**Risk Level:** ðŸŸ¡ **MEDIUM RISK**
**Status:** âœ… MERGED

**Description:** Major UX improvements to worktree selector and creation flow including:

- New WorktreeSelector component
- Improved delete modal
- Restructured worktree UI
- New i18n worktrees files

**Files Changed:** 95 files

**Issues Fixed:**

1. Import path fix: `@roo-code/types` â†’ `@klaus-code/types` in WorktreeSelector.tsx and spec file
2. Missing i18n: Added `%command.worktrees.title%` to all package.nls files

**Tests:**

- All tests pass âœ…

---

## Current Status

| Commit    | Description          | Risk      | Status    |
| --------- | -------------------- | --------- | --------- |
| 953c7773c | zh-TW translations   | ðŸŸ¢ LOW    | âœ… MERGED |
| b472c1522 | Settings UI fix      | ðŸŸ¢ LOW    | âœ… MERGED |
| c28478eda | MCP wildcard support | ðŸŸ¡ MEDIUM | âœ… MERGED |
| c56f0f43c | Worktree UI overhaul | ðŸŸ¡ MEDIUM | âœ… MERGED |

**Total to Merge:** 4
**Merged:** 4
**Remaining:** 0

---

## Files to Protect (Do Not Overwrite)

```
src/api/providers/claude-code.ts
src/integrations/claude-code/oauth.ts
src/integrations/claude-code/streaming-client.ts
packages/types/src/providers/claude-code.ts
webview-ui/src/components/settings/providers/ClaudeCode.tsx
webview-ui/src/components/settings/providers/ClaudeCodeRateLimitDashboard.tsx
```

---

## Branding Verification

All checks passed:

- âœ… Extension name in `src/package.json` is "klaus-code"
- âœ… Publisher is "KlausCode" in `src/package.json`
- âœ… UI strings mention "Klaus Code" not "Roo Code"
- âœ… README files reference Klaus Code repository
- âœ… No "@roo-code" imports in TypeScript files (fixed in WorktreeSelector)

---

**Created:** 2026-01-25
**Completed:** 2026-01-25
**Tracking:** docs/2026.01.25-merge-new-commits.md

---

## Related Documentation

- **Comprehensive Status:** `docs/2026.01.25-upstream-status.md` - Complete mapping of all merged commits and sync status
- **Previous Batch:** `docs/2026.01.24-merge-upstream.md` - 21 commits merged on 2026-01-24
- **High-Risk Analysis:** `docs/commit-8-9-analysis.md` - Detailed analysis of tool handling commits
