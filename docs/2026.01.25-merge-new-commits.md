# Upstream Merge Tracking - 2026-01-25 (New Commits)

## Overview

This document tracks the merge of 4 new upstream Roo Code commits into Klaus Code.

**Upstream Repository:** https://github.com/RooCodeInc/Roo-Code
**Last Merged Commit:** c7910a99c (2026-01-24)
**Target Commit:** 953c7773c (2026-01-25)
**Total Commits to Merge:** 4

## Critical Areas to Protect

Klaus Code maintains these features that must not be affected:

1. **Claude Code Provider** (`src/api/providers/claude-code.ts`, `src/integrations/claude-code/`)
2. **OAuth Integration** (`src/integrations/claude-code/oauth.ts`)
3. **Tool Name Prefixing** (`src/integrations/claude-code/streaming-client.ts`)
4. **Klaus Code Branding** (various files)

## Commit Tracking

Legend:

- üü¢ **LOW RISK** - Safe to merge, minimal conflicts expected
- üü° **MEDIUM RISK** - Review carefully, may affect related systems
- üî¥ **HIGH RISK** - Critical review needed, may impact Claude Code provider/OAuth

---

### 1. 953c7773c - Update and improve zh-TW Traditional Chinese locale and docs (#10953)

**Date:** 2026-01-25
**Author:** Peter Dave Hello
**Risk Level:** üü¢ **LOW RISK**

**Description:** Updates and improves zh-TW (Traditional Chinese) translations for locale files and docs.

**Potential Impact:**

- None - translation updates only
- May affect Klaus Code branding in Chinese translations

**Status:** ‚è≥ PENDING

**Files to Check:**

- `locales/zh-TW/CODE_OF_CONDUCT.md`
- `locales/zh-TW/CONTRIBUTING.md`
- `locales/zh-TW/README.md`
- `webview-ui/src/i18n/locales/zh-TW/*.json`

**Action Items:**

- Check for any Roo Code branding in zh-TW files that should be Klaus Code
- Verify README updates mention correct repository

---

### 2. b472c1522 - fix: restore opaque background to settings section headers (#10951)

**Date:** 2026-01-25
**Author:** roomote[bot]
**Risk Level:** üü¢ **LOW RISK**

**Description:** Restores opaque background to settings section headers that were made transparent.

**Potential Impact:**

- UI fix only, no logic changes
- May affect custom styling in Klaus Code

**Status:** ‚è≥ PENDING

**Files to Check:**

- `webview-ui/src/components/settings/SectionHeader.tsx`

---

### 3. c28478eda - feat: add wildcard support for MCP alwaysAllow configuration (#10948)

**Date:** 2026-01-24
**Author:** roomote[bot]
**Risk Level:** üü° **MEDIUM RISK**

**Description:** Adds wildcard support (`*`) for MCP alwaysAllow configuration, allowing users to approve all tools from a server.

**Potential Impact:**

- MCP alwaysAllow configuration changes
- Test coverage for new wildcard feature
- May affect existing alwaysAllow behavior

**Status:** ‚è≥ PENDING

**Files to Check:**

- `src/services/mcp/McpHub.ts` - Wildcard matching logic
- `src/services/mcp/__tests__/McpHub.spec.ts` - New tests

**Notes:** Should not affect Claude Code provider - separate MCP functionality.

---

### 4. c56f0f43c - ux: improve worktree selector and creation UX (#10940)

**Date:** 2026-01-24
**Author:** Bruno Bergher
**Risk Level:** üü° **MEDIUM RISK**

**Description:** Major UX improvements to worktree selector and creation flow including:

- New WorktreeSelector component
- Improved delete modal
- Restructured worktree UI
- New i18n worktrees files

**Potential Impact:**

- **High file count:** 97 files changed
- UI component restructuring
- Many i18n files (25 languages)
- Worktree selector component
- May affect Klaus Code branding in UI

**Status:** ‚è≥ PENDING (HIGH RISK - large UI changes)

**Files to Check:**

**Critical (preserve Klaus Code):**

- `webview-ui/src/App.tsx` - Check for branding
- `webview-ui/src/components/chat/ChatView.tsx` - Check for branding
- `webview-ui/src/components/settings/SettingsView.tsx` - Check for branding

**UI Components:**

- `webview-ui/src/components/chat/WorktreeSelector.tsx` - NEW component
- `webview-ui/src/components/chat/__tests__/WorktreeSelector.spec.tsx` - NEW tests
- `webview-ui/src/components/worktrees/CreateWorktreeModal.tsx`
- `webview-ui/src/components/worktrees/DeleteWorktreeModal.tsx` - NEW component
- `webview-ui/src/components/worktrees/WorktreesView.tsx`

**i18n Files:**

- `src/i18n/locales/*/worktrees.json` - 25 language files
- `webview-ui/src/i18n/locales/*/worktrees.json` - 25 language files

**Settings:**

- `packages/types/src/global-settings.ts` - Type changes
- `packages/types/src/vscode-extension-host.ts` - Type changes

**Branding:**

- `locales/zh-TW/README.md` - May need Klaus Code update

**Action Items:**

1. Review all UI component changes for Klaus Code branding
2. Add Klaus Code branding to new WorktreeSelector if needed
3. Check if worktree i18n files need Klaus Code updates
4. Verify SettingsView changes don't break Klaus Code settings
5. Run UI tests after merge

---

## Merge Strategy

### Recommended Approach

1. **Batch 1 (Safe):** Commit 1 (translation updates) and 2 (UI fix)
2. **Batch 2 (Medium Risk):** Commit 3 (MCP wildcard feature)
3. **Batch 3 (High Risk):** Commit 4 (worktree UI overhaul)

### Pre-Merge Checklist

- [ ] `git stash` any local changes
- [ ] `git checkout main && git pull origin main`
- [ ] `git fetch roocode`
- [ ] Review each commit's diff

### Testing After Each Merge

- [ ] `pnpm install` (if dependencies changed)
- [ ] `pnpm check-types` (type check)
- [ ] `pnpm test` (run all tests)
- [ ] `cd src && npx vitest run integrations/claude-code/__tests__/` (Claude Code tests)
- [ ] Manual UI testing for worktree changes

---

## Current Status

| Commit    | Description          | Risk      | Status     |
| --------- | -------------------- | --------- | ---------- |
| 953c7773c | zh-TW translations   | üü¢ LOW    | ‚è≥ PENDING |
| b472c1522 | Settings UI fix      | üü¢ LOW    | ‚è≥ PENDING |
| c28478eda | MCP wildcard support | üü° MEDIUM | ‚è≥ PENDING |
| c56f0f43c | Worktree UI overhaul | üü° MEDIUM | ‚è≥ PENDING |

**Total to Merge:** 4
**Merged:** 0
**Remaining:** 4

---

## Files to Protect (Do Not Overwrite)

```
src/api/providers/claude-code.ts
src/integrations/claude-code/oauth.ts
src/integrations/claude-code/streaming-client.ts
packages/types/src/providers/claude-code.ts
webview-ui/src/components/settings/providers/ClaudeCode.tsx
webview-ui/src/components/settings/providers/ClaudeCodeRateLimitDashboard.tsx
```

---

## Branding Check List

After each merge, verify Klaus Code branding:

- [ ] Extension name in `src/package.json` is "klaus-code"
- [ ] Publisher is "KlausCode" in `src/package.json`
- [ ] UI strings mention "Klaus Code" not "Roo Code"
- [ ] README files reference Klaus Code repository
- [ ] No "@roo-code" imports in TypeScript files

---

**Created:** 2026-01-25
**Tracking:** docs/2026.01.25-merge-new-commits.md
